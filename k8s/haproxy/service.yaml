apiVersion: v1
kind: Service
metadata:
  name: haproxy
  namespace: haproxy
  labels:
    app.kubernetes.io/name: haproxy
    app.kubernetes.io/component: load-balancer
    environment: production
  annotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8404"
    prometheus.io/path: "/metrics"
spec:
  type: ClusterIP
  selector:
    app.kubernetes.io/name: haproxy
  ports:
    - name: http
      port: 80
      targetPort: 80
      protocol: TCP
    - name: stats
      port: 8404
      targetPort: 8404
      protocol: TCP
    - name: health
      port: 8405
      targetPort: 8405
      protocol: TCP
  sessionAffinity: None
